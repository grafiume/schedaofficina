<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ELIP TAGLIENTE — SCHEDA RIPARAZIONI</title>
  <!-- CSP: abilita Supabase REST -->
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'self'; connect-src 'self' https://pedmdiljgjgswhfwedno.supabase.co; img-src 'self' data:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'">

  <style>
    :root{
      --bg:#f6f8fa; --card:#fff; --muted:#6b7280;
      --border:#e5e7eb; --primary:#ff8a00; --primary-dark:#e27a00;
      --btn:#2563eb; --btn2:#16a34a;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif;color:#111827}
    .container{max-width:1100px;margin:0 auto;padding:16px}
    .navbar{background:#fff;border-bottom:1px solid var(--border);}
    .navbar .inner{max-width:1100px;margin:0 auto;display:flex;gap:16px;align-items:center;padding:8px 16px}
    .logo{display:flex;gap:8px;align-items:center;font-weight:800;letter-spacing:.3px}
    .logo .brand{color:#111827}
    .title{font-size:14px;color:#6b7280;font-weight:700}
    .nav-btn{margin-left:auto;display:flex;gap:8px}
    .btn{background:#fff;border:1px solid var(--border);border-radius:8px;padding:6px 10px;cursor:pointer}
    .btn-primary{background:var(--primary);color:#fff;border:none}
    .btn-primary:hover{background:var(--primary-dark)}
    .page-title{font-size:28px;font-weight:800;margin:18px 0}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:16px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:12px}
    .card h3{margin:0 0 10px 0;font-size:14px;letter-spacing:.2px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .row3{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .form-group{display:flex;flex-direction:column;gap:6px}
    .form-group label{font-size:12px;color:#374151}
    .form-control{padding:10px;border:1px solid var(--border);border-radius:8px;width:100%;background:#fff}
    .toolbar{display:flex;gap:8px;margin-top:10px}
    .btn-save{background:var(--primary);color:#fff;border:none;border-radius:8px;padding:10px 16px;font-weight:700;cursor:pointer}
    .btn-cancel{border:1px solid var(--border);background:#fff;border-radius:8px;padding:10px 16px;font-weight:700;cursor:pointer}
    /* Sidebar preview */
    .thumb{width:100%;aspect-ratio:4/3;border-radius:8px;background:#e5e7eb}
    .hint{font-size:12px;color:var(--muted);margin:8px 0}
    .upload{display:flex;gap:8px}
    .u-btn{background:#fff;border:1px solid var(--border);border-radius:8px;padding:8px 12px;cursor:pointer}
    .tag{display:inline-block;border:1px solid var(--border);border-radius:999px;padding:4px 8px;font-size:12px;color:#374151}
    /* Preventivo mini-box inherits card */
    .prev-card .head{font-weight:800;margin-bottom:6px}
    .prev-row{display:flex;gap:8px;align-items:center}
    .small{font-size:12px;color:#6b7280}
    @media (max-width:960px){.grid{grid-template-columns:1fr}}
  </style>
</head>

<!-- Imposta qui l'ID della scheda reale, oppure apri con ?rid=<UUID> -->
<body data-record-id="RECORD-UUID-QUI">
  <div class="navbar">
    <div class="inner">
      <div class="logo">
        <span class="brand">ELIP TAGLIENTE</span>
        <span class="title">SCHEDA RIPARAZIONI</span>
      </div>
      <div class="nav-btn">
        <button class="btn">Home</button>
        <button class="btn">Ricerca</button>
        <button class="btn btn-primary">Nuova scheda</button>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="page-title">Modifica scheda</div>

    <div class="grid">
      <!-- Colonna principale -->
      <div class="col">
        <div class="card">
          <h3>Dati scheda e cliente</h3>

          <div class="row">
            <div class="form-group">
              <label>Descrizione</label>
              <input class="form-control" placeholder="es. 1 indotto con due c">
            </div>
            <div class="form-group">
              <label>Modello</label>
              <input class="form-control" placeholder="es. XYZ-123">
            </div>
          </div>

          <div class="row">
            <div class="form-group">
              <label>Data apertura</label>
              <input class="form-control" placeholder="gg/mm/aaaa">
            </div>
            <div class="form-group">
              <label>Data accettazione</label>
              <input class="form-control" placeholder="gg/mm/aaaa">
            </div>
          </div>

          <div class="row">
            <div class="form-group">
              <label>Stato</label>
              <input class="form-control" value="In lavorazione">
            </div>
            <div class="form-group">
              <label>Documento Trasporto</label>
              <input class="form-control" placeholder="ddt n 67 del 23/10">
            </div>
          </div>

          <div class="row">
            <div class="form-group">
              <label>Nome / Ragione sociale</label>
              <input class="form-control" placeholder="">
            </div>
            <div class="form-group">
              <label>Email</label>
              <input class="form-control" placeholder="">
            </div>
          </div>

          <!-- Mini box Preventivo -->
          <div id="preventivo-mount" class="card prev-card" style="margin-top:10px;">
            <div class="head">Collegamento al preventivo</div>
            <div class="prev-row">
              <input id="preventivo_url" class="form-control" placeholder="https://grafiume.github.io/preventivi-elip/?pvid=..." style="flex:1">
              <button id="btn_prev_save" class="btn u-btn" style="background:#2563eb;color:#fff">Salva</button>
              <a id="btn_prev_open" class="btn u-btn" target="_blank" rel="noopener" style="background:#16a34a;color:#fff">Apri</a>
            </div>
            <div id="prev_help" class="small" style="margin-top:6px;"></div>
          </div>

        </div>

        <div class="card">
          <h3>Dati tecnici</h3>
          <div class="row3">
            <div class="form-group">
              <label>Batt. collettore</label>
              <input class="form-control" value="16">
            </div>
            <div class="form-group">
              <label>Lunghezza asse</label>
              <input class="form-control" value="284">
            </div>
            <div class="form-group">
              <label>Larghezza pacco</label>
              <input class="form-control" value="70">
            </div>
          </div>

          <div class="row">
            <div class="form-group">
              <label>N. punte</label>
              <input class="form-control" value="">
            </div>
            <div class="form-group">
              <label>Note</label>
              <input class="form-control" value="rendere cassetta">
            </div>
          </div>

          <div class="toolbar">
            <button class="btn-save">Salva scheda</button>
            <button class="btn-cancel">Annulla</button>
          </div>
        </div>
      </div>

      <!-- Colonna laterale -->
      <div class="col">
        <div class="card">
          <h3>Anteprima immagine <span class="tag">4:3 · adattata</span></h3>
          <div class="thumb"></div>
          <div class="hint">Suggerimento: la prima immagine caricata verrà mostrata qui sopra.</div>

          <div class="form-group">
            <label>Carica immagini (multiplo)</label>
            <div class="upload">
              <button class="u-btn">Scegli file</button>
              <button class="u-btn">Carica su cloud</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Script integrazione "lite" già incluso -->
  <script src="./js/preventivo-link-lite.js?v=20251024"></script>
</body>
</html>
